<div class="container mt-3">
  <h3 class="page-title text-center mb-4">Gestion des Réservations</h3>

  <!-- Filters -->
<div class="form-row mb-3">
  <label class="form-label">Choisir un Pays</label>
<select class="form-select" [(ngModel)]="selectedPaysId" (change)="onPaysChange()">
  <option [ngValue]="undefined" disabled>-- Sélectionner un pays --</option>
  <option *ngFor="let pays of paysList" [ngValue]="pays.id_country">{{ pays.pays }}</option>
</select>



</div>




  <!-- Reservation Cards -->
  <div *ngIf="reservations.length === 0" class="alert alert-info">
    Aucune réservation disponible.
  </div>

  <div *ngFor="let r of reservations" class="card mb-3 shadow-sm">
    <div class="row g-0">
      <div class="col-md-4 d-flex align-items-center justify-content-center">
        <img [src]="r.appartements?.image ? '/assets/' + r.appartements?.image : '/assets/images/app1.png'" 
             class="img-fluid rounded-start" alt="{{ r.appartements?.titre }}">
      </div>
      <div class="col-md-8">
        <div class="card-body">
          <strong>Pays:</strong> {{ r.paysNom || '---' }} <br>
          <strong>Résidence:</strong> {{ r.residenceNom || '---' }} <br>
          <strong>Bloc:</strong> {{ r.blocNom || '---' }} <br>
          <strong>Appartement:</strong> {{ r.appartements?.titre }} <br>
          <p>{{ r.appartements?.description || 'Pas de description disponible' }}</p>

          <p><strong>Du:</strong> {{ r.dateDebut }} <br><strong>Au:</strong> {{ r.dateFin }}</p>

          <p>
            <strong>Status:</strong>
            <span [ngClass]="{
              'text-success': r.approved === 1,
              'text-danger': r.approved === 0,
              'text-warning': r.approved === 2
            }">
              {{ r.approved === 1 ? 'Approuvé' : (r.approved === 0 ? 'Refusé' : 'En attente') }}
            </span>
          </p>

          <div *ngIf="r.approved === 2">
            <button class="btn btn-success me-2" (click)="acceptReservation(r)">Accepter</button>
            <button class="btn btn-danger" (click)="declineReservation(r)">Refuser</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
